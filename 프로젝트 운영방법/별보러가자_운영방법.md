# â­ ë³„ ë³´ëŸ¬ ê°€ì â­

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ  
---  

<div align=center> 
    <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=white"> 
    <img src="https://img.shields.io/badge/Vite-646CFF?style=for-the-badge&logo=Vite&logoColor=white"> 
    <img src="https://img.shields.io/badge/AFrame-EF2D5E?style=for-the-badge&logo=A-Frame&logoColor=white"> 
    <img src="https://img.shields.io/badge/Three.js-000000?style=for-the-badge&logo=Three.js&logoColor=white"><br/><br/>
    <img src="https://img.shields.io/badge/Spring Boot-6DB33F?style=for-the-badge&logo=Spring Boot&logoColor=white">    
    <img src="https://img.shields.io/badge/Apach Kafka-231F20?style=for-the-badge&logo=Apache Kafka&logoColor=white">
    <img src="https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=Redis&logoColor=white">
    <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=MySQL&logoColor=white"><br/><br/>
    <img src="https://img.shields.io/badge/Notion-001234?style=for-the-badge&logo=Notion&logoColor=white">
    <img src="https://img.shields.io/badge/MatterMost-0058CC?style=for-the-badge&logo=MatterMost&logoColor=white">
    <img src="https://img.shields.io/badge/Gitlab-FC6D26?style=for-the-badge&logo=Gitlab&logoColor=white">
    <img src="https://img.shields.io/badge/Jira-0052CC?style=for-the-badge&logo=Jira&logoColor=white">


</div>

# ì„œë¹„ìŠ¤ ì†Œê°œ
## ë©”íƒ€ë²„ìŠ¤ ì²œë¬¸ ì²´í—˜ í”Œë«í¼

## ê¸°ë³¸ ê°œë°œ í™˜ê²½ ğŸ’¾ 

1. ### JAVA 11
2. ### Front-end
    - React 18.0.0
    - aframe 1.3.0
    - three 0.139.2
3. ### Back-end
    - SpringBoot
    - JPA
    - Kafka
4. ### DB
    - MysQL
    - Redis
5. ### ê¸°íƒ€ ê¸°ìˆ 
    - Jenkins
    - AWS
    - Docker
6. ### Ubuntu 20.04 LTS

## í¬íŠ¸ ì •ë³´ âš™
> Spring Boot : 9999, 9998  
> MySQL : 3307  
> Redis : 3308  
> Jenkins : 9090, 50000  
> ì£¼í‚¤í¼ : 2181,2182,2183  
> Kafaka : 9091,9092,9093,9991,9992,9993  


## êµ¬ë™ì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”í•œ ê²ƒë“¤ ğŸ‘©â€ğŸ«
1. AWS DOCKER ì„¤ì¹˜
2. Certbot ì„¤ì¹˜
3. Java 11 ì„¤ì¹˜
4. nginx ì„¤ì¹˜
5. MySQL Dockerë¡œ ì„¤ì¹˜
6. Kafka ì„¤ì¹˜
## ìš´ì˜ë©”ë‰´ì–¼ ğŸ‰
### â— ì£¼ì˜í•  ì 
> ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ë©´ì„œ í•„ìš”í•œ ê³„ì • IDì™€ ë¹„ë°€ë²ˆí˜¸ëŠ” ëª¨ë‘ **imlah**ë¡œ ì„¤ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

### ê°œë°œ í™˜ê²½
ë„ë©”ì¸ ì£¼ì†Œ ì˜ˆì‹œ : k6b102.p.ssafy.io  

[1. Docker ì„¤ì¹˜](#Docker-ì„¤ì¹˜)  
[2. Docker-Compose ì„¤ì¹˜](#Docker-Compose-ì„¤ì¹˜)  
[3. Certbot ì„¤ì •](#Certbot-ì„¤ì •)  
[4. DB ì„¤ì¹˜](#DB-ì„¤ì¹˜)
[5. Redis ì„¤ì¹˜](#Redis-ì„¤ì¹˜)
[6. Nginx ì„¤ì •](#Nginx-ì„¤ì •)  
[7. Kafka ì„¤ì¹˜](#Kafka-ì„¤ì¹˜)
[8. ë°±ì—”ë“œ ì‹¤í–‰](#ë°±ì—”ë“œ-ì‹¤í–‰)
[9. í”„ë¡ íŠ¸ ì‹¤í–‰](#í”„ë¡ íŠ¸-ì‹¤í–‰)
## Docker ì„¤ì¹˜
```bash
# íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸
sudo apt-get update
# ë„ì»¤ ì„¤ì¹˜
sudo apt-get install docker.io -y
# docker ì„œë¹„ìŠ¤ ì‹¤í–‰
sudo service docker start
# ê¶Œí•œ ë¶€ì—¬
sudo chmod 666 /var/run/docker.sock
```
---
## ğŸˆ
## Docker-Compose-ì„¤ì¹˜
1. docker-compose ìµœì‹  ë²„ì „ ì„¤ì¹˜
```bash
sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose
```

2. docker-compose ê¶Œí•œ ì„¤ì •
```bash
sudo chmod +x /usr/local/bin/docker-compose
```

3. docker version í™•ì¸
```bash
docker-compose version
```
---
## ğŸ†
## DB MySQL ì„¤ì¹˜
### 1. mysql ì´ë¯¸ì§€ ë°›ê¸°
```bash
docker pull mysql
```

### 2. ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```bash
docker run --name ì»¨í…Œì´ë„ˆì´ë¦„ -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=ë¹„ë²ˆ ì´ë¯¸ì§€ì´ë¦„

# ê¸°ë³¸
# docker run --name mysql -d -p 3307:3307 -e MYSQL_ROOT_PASSWORD=ssafy mysql
## ë¶ˆë¥¨ ì„¤ì •
# docker run -v mysql_volume:/var/lib/mysql --name mysql -d -p 3307:3307 -e MYSQL_ROOT_PASSWORD=ssafy mysql

# -v {ë¶ˆë¥¨ì´ë¦„}:ë§ˆìš´íŠ¸í• ì£¼ì†Œ --name ì»¨í…Œì´ë„ˆì´ë¦„ -d -p {ì ‘ì†í•˜ëŠ”í¬íŠ¸}:{í¬ì›Œë”©ë˜ëŠ”í¬íŠ¸} -e ~~
- -d : ì»¨í…Œì´ë„ˆë¥¼ ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰
- -p : 3306:3306 í˜¸ìŠ¤íŠ¸-ì»¨í…Œì´ë„ˆ ê°„ í¬íŠ¸ ì—°ê²°. í˜¸ìŠ¤íŠ¸ì—ì„œ 3306í¬íŠ¸ ì ‘ì† ì‹œ ì¼„í…Œì´ë„ˆ 3306 í”„í† ë¡œ í¬ì›Œë”© ë¨.
- -e : MYSQL_ROOT_PASSWORD=ë¹„ë²ˆ : ì»¨í…Œì´ë„ˆ ë‚´ í™˜ê²½ë³€ìˆ˜ ì„¤ì •. root ê³„ì •ì˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ mariadbë¡œ ì§€ì •
- mariadb : ë‹¤ìš´ë¡œë“œ ë°›ì€ ì´ë¯¸ì§€ ì´ë¦„  
```

### 3. MySQL DOcker ì»¨í…Œì´ë„ˆ ì ‘ì†
```bash
docker exec -it mysql bash
```

### 4. ì‹œê°„ ìˆ˜ì •
```bash
vim etc/mysql/my.cnf

[mysqld]
default-time-zone='+9:00'
```
### 5. ê³„ì • ì¶”ê°€
mysql -u root -p  ì ‘ì† í›„
```bash
create user 'username'@'%' identified by 'password';
grant all privileges on *.* to 'username'@'%';
flush privileges;

## í˜„ì¬ ì‹¤ìŠµ ì„¤ì •ìœ¼ë¡œëŠ” ê³„ì • : imlah ë¹„ë°€ë²ˆí˜¸ : imlah ì¸ ê³„ì • ë° star Databaseë¥¼ ë§Œë“¤ì–´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.
```
  
## ğŸ‘•
## Redis ì„¤ì¹˜

1. docker pull redis
```bash
docker pull redis 
```
2. ì´ë¯¸ì§€ í™•ì¸
``` 
docker images
```
3. ë„ì»¤ë¡œ ë§Œë“¤ê¸°
```bash
sudo docker run -d -p 6380:6379 --name ì´ë¦„ redis --requirepass ë¹„ë²ˆ
# imlah

# volume ë§ˆìš´íŠ¸
# docker run -v {ë¶ˆë¥¨ì´ë¦„orê²½ë¡œ}:{ë§ˆìš´íŠ¸í•  ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê²½ë¡œ} -d -p 3308:6379 --name {ì»¨í…Œì´ë„ˆ ì´ë¦„} redis --requirepass {ë¹„ë²ˆ}
docker run -v redisData:/data -d -p 3308:6379 --name redis redis --requirepass imlah
```
4. ì ‘ì† í…ŒìŠ¤íŠ¸
```bash
docker exec -it ì»¨í…Œì´ë„ˆì•„ì´ë”” redis-cli 
```

## ğŸ‡  
## Certbot ì„¤ì •
### https ì„¤ì •ì„ ìœ„í•œ Certbot ì„¤ì •  

### Nginx ì„¤ì¹˜
```bash
sudo apt install -y nginx
```
### Certbot ì„¤ì¹˜
```bash
sudo snap install --classic certbot
```

### ì¸ì¦ì„œë°œê¸‰
```bash
sudo certbot --nginx -d {ë°œê¸‰ë°›ì„ ë„ë©”ì¸}

# ì´ë©”ì¼ ì…ë ¥
# ì„œë¹„ìŠ¤ ì•½ê´€ ë™ì˜
# 1. No redirect, Redirect ì„¤ì •
```

### SSL ìë™ ê°±ì‹ 
```bash
sudo certbot renew --dry-run

#Congraturation ëœ¨ë©´ ì ìš© ëœê²ƒ

# ìˆ˜ë™ ê°±ì‹  -> sudo certbot renew
```

### í‚¤ í™•ì¸
```bash
cd /etc/letsencrypt/live/{ë„ë©”ì¸}
```

### pem ì¸ì¦ì„œ pkcs12ë¡œ ë³€í™˜
```bash
cd /etc/letsencrypt/live/{ë„ë©”ì¸}

# openssl pkcs12 -export -inkey {privkey} -in {certificate} -out {pkcs12 í‚¤ ì´ë¦„}
openssl pkcs12 -export -inkey privkey.pem -in cert.pem -out ssafykey.p12
# ì´í›„ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
```
---
## ğŸƒ
## Nginx ì„¤ì •
1. Nginx ì„¤ì •
```bash
cd /etc/nginx/sites-enabled
nano default
```
2. default ì„¤ì • ë‚´ìš©
```bash
server {
	listen 80 default_server;
	listen [::]:80 default_server;

#	root /var/www;
	root /var/jenkins/workspace/star/frontend/dist;

	# Add index.php to the list if you are using PHP
	index index.html index.htm index.nginx-debian.html;

	server_name k6b102.p.ssafy.io;

	location / {
#		try_files $uri $uri/ index.html;
		return $uri /index.html
	}	
}
```

3. Nginx êµ¬ë™
```bash
service nginx restart
```
---
## ğŸ Kafka ì„¤ì¹˜
1. docker-compose ìœ„ì¹˜ë¡œ ì´ë™
```bash
cd /exec/ìš´ì˜ë°©ë²•
```
2. kafka ì„¤ì¹˜
```bash
docker-compose up
```
3. Topic ìƒì„±
```bash
# ë”°ë¡œ ìƒì„±ì„ ì•ˆí•´ì£¼ì–´ë„ ë°±ì—”ë“œ ì†ŒìŠ¤ ë™ì‘í•˜ë©´ì„œ ê¸°ë³¸ì ìœ¼ë¡œ Topic ìƒì„±ì€ ì§„í–‰ë©ë‹ˆë‹¤.
docker exec -it kafka1 bash

kafka-topics --bootstrap-server kafka1:9091 --create --topic chat-test --partitions 3 --replication-factor 3
```
  
## ğŸ¥ ë°±ì•¤ë“œ ì‹¤í–‰
1. Docker ì´ë¯¸ì§€ ì„¤ì¹˜
```bash
docker pull yunghun97/star # ê¸°ë³¸ Backend ì†ŒìŠ¤
docker pull yunghun97/star_chat # í”„ë¡ íŠ¸ Websocket ê´€ë ¨ ë°±ì—”ë“œ ì†ŒìŠ¤
```
2. Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```bash
docker run -d -p 9999:9999 --name star yunghun97/star
docker run -d -p 9998:9998 --name star yunghun97/star_chat
```

## ğŸ§© í”„ë¡ íŠ¸ ì‹¤í–‰
- ì‹¤í–‰ ì»¤ë§¨ë“œ
```bash
npm run dev
```
- ë¹Œë“œ ì»¤ë§¨ë“œ
```bash
npm run build
```
  
---  
## ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰êµ¬ë™ì¤€ë¹„ê°€ ëë‚¬ìŠµë‹ˆë‹¤.!! ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰
